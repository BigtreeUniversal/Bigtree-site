<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Calculateur Soleil & Lune</title>
  <style>
    body {
      background-color: black;
      color: lime;
      text-align: center;
      font-family: monospace;
    }
    .map-container {
      position: relative;
      display: inline-block;
    }
    .map-container img {
      width: 100%;
      max-width: 400px;
    }
    .dot {
      width: 14px;
      height: 14px;
      border-radius: 50%;
      position: absolute;
      transform: translate(-50%, -50%);
    }
    .sun { background: yellow; }
    .moon { background: lightblue; }
  </style>
</head>
<body>
  <h1>üåû Calculateur Soleil & üåô Lune</h1>

  <div class="map-container" id="map">
    <img src="flatmap.jpg" alt="Carte azimutale"> <!-- change image si besoin -->
    <div class="dot sun" id="sunDot"></div>
    <div class="dot moon" id="moonDot"></div>
  </div>

  <p id="status">Chargement des donn√©es...</p>

  <script>
    async function getData() {
      try {
        const lat = 48.8566;  // Exemple : Paris
        const lon = 2.3522;
        const response = await fetch(`https://syncrolink-server.onrender.com/sunmoon?lat=${lat}&lon=${lon}`);
        const data = await response.json();

        document.getElementById('status').textContent = "Donn√©es √† jour ‚úîÔ∏è";

        placeDot('sunDot', data.sun.azimuth, data.sun.altitude);
        placeDot('moonDot', data.moon.azimuth, data.moon.altitude);

      } catch (e) {
        document.getElementById('status').textContent = "Erreur de chargement ‚ùå";
        console.error(e);
      }
    }

    function placeDot(id, azimuth, altitude) {
      const radius = 150; // pixels, moiti√© de la carte
      const x = radius + radius * Math.cos(azimuth) * (1 - altitude);
      const y = radius + radius * Math.sin(azimuth) * (1 - altitude);

      const dot = document.getElementById(id);
      dot.style.left = `${x}px`;
      dot.style.top = `${y}px`;
    }

    getData();
    setInterval(getData, 5 * 60 * 1000); // mise √† jour toutes les 5 minutes
  </script>
</body>
</html>
